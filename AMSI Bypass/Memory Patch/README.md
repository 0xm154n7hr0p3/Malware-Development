
# 𝐀𝐌𝐒𝐈 𝐁𝐲𝐩𝐚𝐬𝐬: 𝐀𝐦𝐬𝐢 𝐦𝐞𝐦𝐨𝐫𝐲 𝐩𝐚𝐭𝐜𝐡𝐢𝐧𝐠 𝐮𝐬𝐢𝐧𝐠 𝐏𝐨𝐰𝐞𝐫𝐬𝐡𝐞𝐥𝐥.

The fundamental steps of the bypass vulnerability are as follows:

1-𝐋𝐨𝐚𝐝 𝐭𝐡𝐞 𝐚𝐦𝐬𝐢.𝐝𝐥𝐥, which is automatically loaded when a PowerShell session starts.

2-𝐌𝐨𝐝𝐢𝐟𝐲 𝐭𝐡𝐞 𝐀𝐦𝐬𝐢𝐒𝐜𝐚𝐧𝐁𝐮𝐟𝐟𝐞𝐫() function to consistently return AMSI_RESULT_CLEAN by injection 0x80070057 into EAX register 

Some of the Obfuscation Techniques that were used:

*𝐄𝐧𝐜𝐨𝐝𝐞𝐝 𝐖𝐢𝐧32 𝐀𝐏𝐈 𝐂𝐚𝐥𝐥𝐬: To bypass static analysis, we first encode the Win32 API calls using Base64 and XOR operations. These encoded calls are then stored as byte sequences. At runtime, we deobfuscate these sequences and execute them dynamically.

*𝐀𝐬𝐬𝐞𝐦𝐛𝐥𝐲 𝐈𝐧𝐬𝐭𝐫𝐮𝐜𝐭𝐢𝐨𝐧𝐬 𝐟𝐨𝐫 𝐄𝐯𝐚𝐬𝐢𝐨𝐧: Instead of directly loading the detectable value 0x80070057 into the eax register, we use a series of Assembly instructions to achieve the same result indirectly:

mov eax, 0xb39be546

add eax, 0x3efd2145

sub eax, 0x4342d312

xor eax, 0x2f51332e

ret

𝐕𝐢𝐫𝐮𝐬𝐓𝐨𝐭𝐚𝐥 𝐒𝐜𝐚𝐧 𝐑𝐞𝐬𝐮𝐥𝐭𝐬: 2/60
